[{"categories":null,"contents":"Overview This is an attack scenario designed to support incident response and investigation tabletop exercises. Mitigations and detection possibilities are called out at each stage, so you can begin the exercise at any point in the narrative. Whether you then use the previous actions to provide additional context and highlight gaps in detection, or continue the scenario on depending on the actions and responses of participants, is entirely up to you.\nAny actions by the attacker can be automated in a genuine attack. While this scenario is generic and hypothetical, all of the techniques used are ones I have seen exploited to great effect in real life scenarios.\nYou will find here:\n a timeline of the attack with actions by the attacker, employees, and indications of where the incident may be detected before the scenario completes a more detailed explanation of each stage on the timeline suggestions for injects at each point to provide more information to participants in response to the right investigative actions being taken the above as a downloadable PDF  While this is designed to be as generic and applicable as possible, certain assumptions have to be made. This scenario assumes:\n users can remotely login to email a filesharing platform is available and stores sensitive data internal users are connected to an unsegregated internal network  If some of these do not apply, or if you want to narrow the scenario, ignore those injects and activities. You may decide to start the scenario at the end, with the ransom demand being displayed to employees across the network, in which case the previous actions can help guide investigations. Otherwise, start at whichever point you realistically feel the alarm would be raised - the further events can be used to add pressure and identify holes in your incident response plan, if the right actions are not taken or the right questions not asked.\nDetection and prevention boxes on the timeline are not comprehensive or authoritative. The detailed summary of each stage below goes into more detail about possible detection/prevention mitigations, along with explanations of information might be available from any alerting solutions.\nScenario Initial phish A user receives a phishing e-mail. After clicking the link, they are asked to sign in to a page that appears to be the same as your collaboration platform.\nEffective training, or certain anti-phishing technologies, may prevent this. Most of the effective anti-phishing technologies rely on up to date threat intelligence. If the attack is targeted and crafted, not sharing common attributes with ongoing mass attacks detected by these systems, then it is unlikely to be blocked. The same applies to detection systems.\nIf the attack is a first wave from a further mass attack, some anti-phishing systems will pick up that the e-mail was a phish after the fact even if not before. Once reported and determined to be a true positive, these systems can alert you to previously received messages and even retroactively pull them from mailboxes if they are unread. Of course, if it is a mass attack there may be a large number of affected users and many of the further steps in this narrative are likely to be automated and occur within seconds, or at most minutes.\nAttacker gains access Armed with valid user credentials the attacker now logs into the webmail service, or uses a mail client, to pull down the company address book and gather intelligence for further exploitation. A common indicator that this has happened, which can remain in place for days if an attack has gone unnoticed, is a forwarding rule set in the user\u0026rsquo;s mailbox. At later stages this is something an incident response playbook for any sort of mailbox access breach should look for, and ideally a rule monitoring for any forwarding rules outside the company should be in place.\nWith automated attacks, the forwarding rule and download of the organisation address book (and therefore organisation chart) will usually be set up within seconds of the breach. Even when later stages are manual this initial set of actions is often automated.\nRestricting remote access to only authorised endpoints is the most effective defense, however in the days of bring your own device (BYOD) this is rarely set up. Multi-factor authentication is another protection which can be effective, although SIMjacking and social engineering methods can work around these.\nConditional access security, or user behaviour analytics, are another defense which can either prevent an attacker from gaining access or alert to them doing so. A suitable inject here would be an alert that a user is logging on outside of their regular working hours, or from a location it would be impossible for them to have travelled to in the time since their last logon. Quick action at this point in locking out the account and contacting the user can help mitigate the later stages of the scenario, but again in an automated attack the second wave of communications may already have gone out to internal and external contacts, so should be checked as part of the incident response plan.\nAttacker accesses fileshare At this point the attacker has found links to your filesharing solution, whether integrated with your e-mail platform or independent. Either single sign on is implemented, or the user has reused their password for simplicity. They begin pulling down any content they can get hold of, especially anything that looks interesting, in preparation for the next stage.\nMany of the same defense methods as for webmail will work here, so I will gloss over those. One which comes into its own at this stage is data loss prevention technologies, if properly applied. Depending on the policies set these solutions may prevent users from downloading protectively marked data outside of your environment, or alert on any suspicious downloads. Here is where another inject could enter the scenario, with an alert that the user is downloading large numbers of sensitive documents.\nAttacker uploads a malicious fileshare After finding a suitable file, a PDF or similar with some readily available vulnerabilities in common clients. They take the existing file, use an exploit kit to inject malicious code into it (or if especially enthusiastic, craft their own exploit into the file), and upload it as a new version.\nWith the ease of obfuscating exploit code any signature based detection is going to be ineffective against a prepared attacker. The security team may be alerted to what is going on by an effective sandbox setup which quarantines any new files and executes them in a prepared environment to test for any unexpected behaviour. Again, this may be a good point to drop an inject into the scenario if it is a realistic point for detection to happen and the tooling is in place.\nAttacker sends out impersonation e-mails Masquerading as the victim user, the attacker now sends out a number of e-mails asking people to check the file. At this point we are likely talking about a human rather than automated attack, which will either craft a new e-mail based on the user\u0026rsquo;s history or reply to conversations to leverage the existing trust. While training can help here, it is much harder to train people to be cautious of known co-workers than external phishing attacks. The best hope is that one of your employees picks up something odd about the e-mail and reports it quickly, another chance to drop an inject into the room.\nEmployees execute the malware By this point most of the potential defenses have failed, or do not exist. Unless a good endpoint protection solution, whether using sandboxing or otherwise, captures the execution of the malicious payload and prevents compromise it is likely to succeed. Employees will hopefully notice something if the PDF crashes their PDF reader, but there is no guarantee they will know what to look for or will report it.\nRansomware agent begins spreading across network The attacker now has one or more compromised systems within your network. Depending on their level of sophistication the malware may immediately be used to start encrypting data and showing ransom screens. In this scenario, the attacker is willing to play a longer term game and instead allows the malware to quietly spread for a few days.\nWith the right security controls in place unauthorised changes, or attempted changes, to critical systems may be flagged up and warn of what is going on. If this happens there are serious decisions to be made - can parts of the network be quarantined to protect others, what can be sacrificed, and so on. With the appropriate network segregation, or even micro-segmentation, in place the infection spread may be tightly limited. This is a good place for incident response planning, as it forces participants to consider what is and is not critical, and brings to light areas that may have been overlooked.\nRansomware is executed One the ransomware has spread far enough for them, or a set time is reached, it is triggered and begins encrypting files on all compromised hosts.\n","permalink":"https://coffee-fueled.github.io/resources/phishing_scenario/","tags":["incident response","scenario","phishing"],"title":"Attack Scenario: Phishing to Ransom"},{"categories":null,"contents":"Doorstep Dispensaree There are a few lessons to pull out of this case, but for those who want to look at the details themselves the full ICO penalty notice is available from their website.\nThe ICO identified a number of failings after they were called in by the MHRA, who had found some curious containers while executing a search warrant for their own investigation. In a courtyard behind the premises they found:\n-47 unlocked crates -2 disposal bags -1 cardboard box These unsecured containers, stored outside, contained around half a million documents – some water damaged – with personal information including medical and prescription information dating from 2016-2018. Shortly after they were informed, the Commissioner sent a request for additional information, a list which will be familiar to anyone who has banged their head against GDPR enough: data retention and disposal policies, privacy notice, explanation of why some data had been retained since 2016 and was stored in this way, and various other standard bits of evidence.\nIn response Doorstep Dispensaree did not cover themselves in glory by denying knowledge of the matter. Things escalated when they then refused to answer questions following a second request, apparently confusing the ICO and MHRA investigations. After an Information Notice was issued requiring the information, then appealed and upheld, they provided about half of the information claiming protection under the DPA 2018 that providing the rest would expose them to prosecution by the MHRA.\nAs part of their documentation, they did kindly provide the National Pharmacy Association template Data Protection Officer Guidance and Checklist, and Definitions and Quick Reference Guide. Other documents did not mention the GDPR, and the template were the original templates from the National Pharmacy Association.\nLessons In all Doorstep Dispensary were found to have contravened Articles 5, 13, 14, 24 and 32 to some degree or another. It’s a good thing for them that no information was stolen, as the ICO would have been unlikely to look on them kindly if anything had happened – especially as given the serious compliance failures it is unlikely any notification of the breach would have been forthcoming until the MHRA investigation flagged it up, and certainly not within the required 72 hours.\nYou cannot delegate responsibility for data you control\nDoorstep Dispensaree failed to dispose of the data securely, fairly clearly as some of it dated from 2016. An attempt was made to have the penalty assigned to a waste disposal company, blaming them for not having picked up the waste, which the ICO dismissed. While no evidence that the company was contracted was provided, Doorstep Dispensaree also failed to implement their own claimed shredding procedures, and in any case as the data controller they are ultimately accountable for the breach.\nInformation security is more than just confidentiality\nApparently storing sensitive personal information in unlocked boxes in an accessible yard is not considered secure storage or processing. As this is fairly obvious, the main point of interest here is that the ICO picked up on water damage to the documents being another failing. In information security terminology, there was a failure to ensure integrity and availability along with confidentiality. There is more to information security than simply locking data away.\nPolicies do not work retroactively\nThe ICO commented that eventually Doorstep Dispensaree did provide a more comprehensive set of policies. Unfortunately many were still in template form and had been acquired as a response to the investigation. The lesson here is that once an investigation has started, it’s probably too late to start downloading policy templates – best to put a framework in place beforehand.\nOnly keep data that needs to be kept\nWhile the ICO were generous enough to only consider on-going infringement from May 2018, they remarked that the age of the data caused some concern about retention.\nBe clear on your privacy notice\nYour privacy notice requires you to state who the controller is and how to contact them, the nature of the processing and the basis (and with special category data the additional basis for processing), the categories of personal data you collect and work with, all parties involved in the processing of data, how long it is retained, the rights of the data subjects, and where personal data is collected. It must also be written in clear, unambiguous language and be freely available to data subjects.\nA GDPR breach does not require that data has been lost or stolen\nWhat’s particularly interesting about this case compared to many of the headlines about cyber-related data protection incidents, is that no data was stolen. The fact that it could have led to distress and damage to individuals is sufficient.\nTrying to improve counts\nThe improvements Doorstep Dispensaree claims to be making have been taken into account, even though some of the policy documents presented are still in template format.\nIf you are found in breach, co-operate\nIt is very clear that the lack of early co-operation did more to hurt than help Doorstep Dispensaree’s case. Later co-operation and attempts to improve were taken into account, and the original proposed penalty of £400 000 was finalised as £275 000.\n","permalink":"https://coffee-fueled.github.io/blog/doorstep_dispensaree/","tags":["ico","gdpr fine","data protection"],"title":"Doorstep Dispensary"},{"categories":null,"contents":"This file exists solely to respond to /search URL with the related search layout template.\nNo content shown here is rendered, all content is based in the template layouts/page/search.html\nSetting a very low sitemap priority will tell search engines this is not important content.\nThis implementation uses Fusejs, jquery and mark.js\nInitial setup Search depends on additional output content type of JSON in config.toml ``` [outputs] home = [\u0026ldquo;HTML\u0026rdquo;, \u0026ldquo;JSON\u0026rdquo;] ```\nSearching additional fields To search additional fields defined in front matter, you must add it in 2 places.\nEdit layouts/_default/index.JSON This exposes the values in /index.json i.e. add category ``` \u0026hellip; \u0026ldquo;contents\u0026rdquo;:{{ .Content | plainify | jsonify }} {{ if .Params.tags }}, \u0026ldquo;tags\u0026rdquo;:{{ .Params.tags | jsonify }}{{end}}, \u0026ldquo;categories\u0026rdquo; : {{ .Params.categories | jsonify }}, \u0026hellip; ```\nEdit fuse.js options to Search static/js/search.js ``` keys: [ \u0026ldquo;title\u0026rdquo;, \u0026ldquo;contents\u0026rdquo;, \u0026ldquo;tags\u0026rdquo;, \u0026ldquo;categories\u0026rdquo; ] ```\n","permalink":"https://coffee-fueled.github.io/search/","tags":null,"title":"Search Results"}]